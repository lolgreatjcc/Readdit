<!--How Zu Kang Adam DIT/FT/1B/03 p2026677-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Readdit</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <script>

        $(document).ready(function () {
            var userData = localStorage.getItem('userInfo');
            var userJsonData = JSON.parse(userData);
            var userid = userJsonData[0].userid;
            
            $.ajax({
                //headers: { 'authorization': 'Bearer ' + tmpToken },
                url: 'https://readdit-backend.herokuapp.com/users/' + userid,
                type: 'GET',
                //contentType: "application/json; charset=utf-8",
                dataType: 'json',
                success: function (data, textStatus, xhr) {
                
                console.log(data);
                console.log(data.Result[0].username);
                $(`#msg`).append(`<h1> Welcome to readdit, ${data.Result[0].username}! </h1>
                                  <h2> Your role: ${data.Result[0].role} </h2>`);

                },
                error: function (xhr, textStatus, errorThrown) {
                    console.log('Error in Operation');
                    console.log(xhr)
                    console.log(textStatus);
                    console.log(errorThrown);
                    console.log(xhr.status);
                    //if (xhr.status == 401) {
                    //    $('$msg').html('Unauthorised User');
                    //}
                }
            });

            // check if we have a valid search query param
            var queryParams = new URLSearchParams(window.location.search);
            console.log("---------Query Parameters---------");
            console.log("Query Param (source): " + window.location.search);
            console.log("Query Param (extracted): " + queryParams);

            // if yes, load just that user
            if (queryParams.has("search_title")) {
                var title = queryParams.get("search_title");
                var price = queryParams.get("search_price");
                var platform = queryParams.get("search_platform");

                console.log("Search Title: " + title);
                console.log("Search Price: " + price);
                console.log("Search Platform: " + platform);

                loadGame(title,price,platform);
            }
            // else, load all users
            else {
                loadAllGames();
            }


        });

    </script>

</head>

<body>
    <div class="container">
    </div>
    <div class="container">
        <div id="msg"></div>
    </div>



</body>

</html>